---
layout: post
title:  "配置关联数据类操作界面"
date:   2018-02-25
visible: 1
---

前面一个教程，您为“事务”数据类定义了一个二维表格界面。该表格界面提供了几个默认的操作，例如添加，修改，删除和附件。我们称其为“标准命令”。除了“标准命令”外，SiteMapStudio允许您创建特殊的操作来扩展应用的功能。我们称这类特殊操作为“定制命令”。

Ebaas平台提供了一些针对定制命令模块。您可以根据应用的需要来进行配置。例如，本教程中“事务”到“意见”存在一个一对多的关系。也就是说，用户可以对某个事务提交多条意见，用于记录事务的处理过程。所以需要提供提交，修改和查看“意见”的界面功能。由于“意见”数据是与“事务”数据关联的，所以可以通过“定制命令”的方式来实现。下面，我们介绍如何使用定制命令来时实现关联数据的操作。

#### 创建“事务”数据类的定制命令组
打开SiteMapStudio工具。 在打开的SiteMapStudio界面中右键选择“定制命令栏” => 从弹出的菜单 => 选择“添加”命令，如下图所示:
<img src="{{'/assets/img/2018-2-25-创建关联数据类操作界面1B.png' | prepend: site.baseurl }}" alt="">

弹出“添加新项”框 => “名称”栏输入：IssueCommands，如下图所示:
<img src="{{'/assets/img/2018-2-25-创建关联数据类操作界面1C.png' | prepend: site.baseurl }}" alt="">

选中“IssueCommands”命令定制组 => 在右边“设置”选项卡参数配置如下：<br>
* 在“显示名”栏输入：事务命令组<br>
* 默认数据库选择：事务跟踪管理<br>
* 数据类选择：事务<br>
结果如下图所示:
<img src="{{'/assets/img/2018-2-25-创建关联数据类操作界面2C.png' | prepend: site.baseurl }}" alt=""><br>

#### 创建“意见”定制命令

右键单击“事务命令组” => 在弹出的“菜单” => “添加” => 在弹出的“添加新项”名称栏输入：Comments，单击“确定”按钮;

<img src="{{'/assets/img/2018-2-25-创建关联数据类操作界面8C.png' | prepend: site.b。seurl }}" alt=""><br>

在“事务命令组”下选择“Comments”节点，在“设置”选项卡中按照表1的参数进行设置：<br>

表1: “意见”定制命令菜单项的设置

| 设置参数名 | 设置参数值 | 描述 |
|-------|--------|---------|
| 名称 | Comments | 定制命令的名称，必须是唯一的 |
| 显示名 | 意见 | 定制命令在用户界面显示的名称 |
| 模块URL |.related | 定制命令使用的界面模块，该模块是二维表格模块 |
| 模块参数 | 配置见表2 |.related界面模块所需的配置参数 |

<img src="{{'/assets/img/2018-2-25-创建关联数据类操作界面5D.png' | prepend: site.baseurl }}" alt=""><br>
点击“模块参数”右边“...”按钮，如下图所示：

在弹出的“定义参数”框，点击“添加”按钮 => 在右边“参数名”输入：relatedclass => “参数值”输入：Comment，如下图所示：

表2: “.related”界面模块的参数

| 设置参数名 | 设置参数值 | 描述 |
|-------|--------|---------|
| relatedclass | Comment | 指定关联数据类的名称 |

<img src="{{'/assets/img/2018-2-25-创建关联数据类操作界面6.png' | prepend: site.baseurl }}" alt=""><br>
“图标名称”输入：fa fa-lg fa-task，最终结果见下图：<br>
<img src="{{'/assets/img/2018-2-25-创建关联数据类操作界面7C1.png' | prepend: site.baseurl }}" alt=""><br>

#### 保存界面模型
点击“文件” => 选择“保存”，如下图所示：
<img src="{{'/assets/img/2018-2-25-保存事务菜单模板C.png' | prepend: site.baseurl }}" alt=""><br>

{% include important.html content="保存后请重启Ebaas服务器。" %}

#### 使用定制命令
使用浏览器登录到Web界面，单击“事务”图标 => 单击某条数据实例 => 在展开的下拉工具栏，单击“意见”图标，如下图所示：
<img src="{{'/assets/img/2018-2-25-使用定制命令1.png' | prepend: site.baseurl }}" alt=""><br>
页面转入“意见”页面，单击右上角“+添加”按钮，如下图所示：
<img src="{{'/assets/img/2018-2-25-使用定制命令2.png' | prepend: site.baseurl }}" alt=""><br>
在弹出的“意见”表单输入相关数据，完成后单击“提交”按钮 => 出现”数据提交成功“信息 => 单击”关闭“按钮，如下图所示：
<img src="{{'/assets/img/2018-2-25-使用定制命令3.png' | prepend: site.baseurl }}" alt=""><br>
最终结果，如下图所示：
<img src="{{'/assets/img/2018-2-25-使用定制命令4.png' | prepend: site.baseurl }}" alt=""><br>

可以点击上方的导航链接返回“事务”数据表格。

