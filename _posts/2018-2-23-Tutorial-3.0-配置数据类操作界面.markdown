---
layout: post
title:  "配置数据类操作界面"
date:   2020-05-23
visible: 1
---

通过前面的教程，您已经创建并保存了一个简单的“事务跟踪管理”的数据模型。Ebaas系统已经根据这个模型在所使用的关系数据库中创建了两个表及相应的字段和关系。您接下来的问题一定是应如何对创建的数据库表进行操作，例如创建，读取，修改和删除操作（或称为CRUD操作）。

在传统的Web应用程序开发中，创建了数据库表后，您需要编写许多代码来实现对数据库的操作，包括界面和服务器端的程序。对于一个程序员来说，实现对数据库的操作可能并不难。如果您的应用需要在数据库中创建几十个甚至上百个数据库表，而且数据模型会经常需要调整时，传统的Web应用开发方式将产生巨大的代码开发工作量并使得开发出来的应用难以维护。

Ebaas平台采用模型驱动的理念来构建整个Web应用。它除了使用您所创建的数据模型来生成数据库表外，还使用这个数据模型来生成用户界面和服务器端的数据库操作逻辑。也就是说，一旦您创建了业务数据模型，再通过配置用户界面，就完成了应用开发。

接下来的教程，我们就介绍如何对界面配置来实现对“事务”及“意见”数据类进行各种操作的过程。

#### 基于模块可插拔机制的用户界面

Ebaas平台提供了一个基于模块可插拔机制的用户界面，并提供了一些可复用的用户界面模块。您可以根据应用需要选择相应的模块进行用户界面的配置。为此，Ebaas平台还提供了一个称为SiteMapStudio的工具，便于您进行界面模块配置的工作。

在本教程中，您将使用SiteMapStudio和一个称为“datagrid”模块来为“事务”数据类配置一个二维表格的操作界面。下面介绍具体步骤：

#### 创建网站模型
从“开始”- > Ebaas-> SiteMapStudio打开SiteMapStudio工具。
在打开的SiteMapStudio界面中选择“文件”下拉菜单的“打开”命令，如下图所示:<br>
<img src="{{'/assets/img/2018-2-23-配置数据类操作界面1.png' | prepend: site.baseurl }}" alt=""><br>
在弹出的“管理员登录”框中，“管理员名称”输入：admin,“管理员密码”输入：admin，如下图所示:<br>
<img src="{{'/assets/img/2018-2-23-配置数据类操作界面2.png' | prepend: site.baseurl }}" alt=""><br>
进入后，选中左边“网站地图集”右键单击，在弹出的菜单选择“添加”，如下图所示：<br>
<img src="{{'/assets/img/2018-2-23-配置数据类操作界面3.png' | prepend: site.baseurl }}" alt=""><br>
在弹出的“添加新项”对话框中，“名称”输入：事务跟踪管理，如下图所示：<br>
<img src="{{'/assets/img/2018-2-23-配置数据类操作界面4.png' | prepend: site.baseurl }}" alt=""><br>
点击“确认”按钮便创建了一个新的网站模型框架，结果见下图所示:<br>
<img src="{{'/assets/img/2018-2-23-配置数据类操作界面5.png' | prepend: site.baseurl }}" alt="">

#### 配置网站模型

选择左边的“事务跟踪管理”网站模型节点，在右边的“设置”选项卡做如下设置：
* 将“默认数据库”选择为“事务跟踪管理 1.0”；
* 将“语言”设置为“cn”， 表示该网站采用中文语言包；
* 其它设置保持默认；

完成的网站模型参数配置最终结果如下图所示：
<img src="{{'/assets/img/2018-2-23-创建事务菜单项6A.png' | prepend: site.baseurl }}" alt="">

#### 创建“事务管理”菜单项

接下来，我们需要在网站模型中创建菜单项。每个菜单项代表用户界面的一项功能。我们首先为访问“事务”数据类创建一个菜单项。创建“事务”菜单项步骤如下：

展开“事务跟踪管理”节点 => 右键单击“菜单栏” => 选择“添加”，如下图所示:
<img src="{{'/assets/img/2018-2-23-创建事务菜单项1.png' | prepend: site.baseurl }}" alt=""><br>
在弹出的“添加新项”框，在“名称”处输入：IssueTracking，如下图所示：
<img src="{{'/assets/img/2018-2-23-创建事务菜单项2.png' | prepend: site.baseurl }}" alt=""><br>
在右边“设置”面板里做如下参数设置,见表1：<br>
表1: “事务”菜单项的设置值

| 设置参数名 | 设置参数值 | 描述 |
|-------|--------|---------|
| 名称 | IssueTracking | 菜单的名称，必须是唯一的 |
| 显示名 | 事务管理 | 菜单在用户界面显示的名称 |
| 模块URL | app.smarttables.datagrid | 菜单使用的界面模块，该模块是二维表格模块 |
| 数据库 | 事务跟踪管理 1.0 | 该菜单指向的数据库 |
| 数据类 | 事务 | 该菜单指向的数据类 |
| 图标名称 | fa fa-fw fa-bug | 指定菜单的图标，可选项 |

数据库设置，单击“数据库”栏右边的“箭头”按钮，从下拉框里选择“事务跟踪管理1.0”，如下图所示：
<img src="{{'/assets/img/2018-2-23-创建事务菜单项3.png' | prepend: site.baseurl }}" alt=""><br>
数据类设置，单击“数据类”栏右边的“---”按钮，如下图所示：
<img src="{{'/assets/img/2018-2-23-创建事务菜单项4.png' | prepend: site.baseurl }}" alt=""><br>
从弹出“已存在的类”框里选择“事务”数据类，如下图所示：
<img src="{{'/assets/img/2018-2-23-创建事务菜单项5.png' | prepend: site.baseurl }}" alt=""><br>

#### 指定当前的“网站模型”

当SiteMapStudio中有多个网站模型时，需要指定一个网站模型为当前网站模型。步骤为选中左边栏“网站地图集”，在“设置”选项卡中“当前网站”右边点击“向下箭头”，在下拉菜单里选择“事务跟踪管理”数据模型，如下图所示：
<img src="{{'/assets/img/2018-2-23 选择网站设置1.png' | prepend: site.baseurl }}" alt="">
最终结果如下图所示：
<img src="{{'/assets/img/2018-2-23 选择网站设置2.png' | prepend: site.baseurl }}" alt="">

#### 设置默认权限

SiteMapStudio允许您为网站模型中的各种元素设置用户访问权限（我们将在后续教程中介绍）。这里，我们将为这个网站模型设置一个允许所有人访问的默认权限，也就是给“事务跟踪管理”网站模型设置一个允许“Everyone”访问权限，该权限会被网站模型中所有菜单项继承：

选中左边栏“事务跟踪管理”的网站模型 => 选择右边“权限控制”选项卡 => 单击“添加”按钮 => 在弹出的“选择用户或角色”框 => 选择“角色”→“Everyone”，如下图所示：
<img src="{{'/assets/img/2018-2-23-权限控制1.png' | prepend: site.baseurl }}" alt="">
单击“确认”按钮，结果见下图：
<img src="{{'/assets/img/2018-2-23-权限控制2.png' | prepend: site.baseurl }}" alt="">

{% include note.html content="‘Everyone’是系统内置的角色，所有系统用户都具有Everyone角色。在后续权限控制教程会进一步介绍。" %}

#### 保存网站模型
选择“文件”下拉菜单的“保存”命令，如下图所示:
<img src="{{'/assets/img/2018-2-23-保存界面模型1.png' | prepend: site.baseurl }}" alt=""><br>
从弹出“Confirm dialog”框里,选择“是（y）”按钮，如下图所示：
<img src="{{'/assets/img/2018-2-23-保存界面模型2.png' | prepend: site.baseurl }}" alt=""><br>

{% include important.html content="创建或修改网站模型并保存后，需要重启Ebaas服务器才能使修改生效。" %}

#### 重启Ebaas服务器
首先需要终止Ebaaas服务器。 步骤如下：

在Windows桌面显示Ebaas服务器的CMD窗口，可以按“Ctl+C”或点击窗口右上方的“x”按键关闭该窗口来终止服务器，见下图：<br>
<img src="{{'/assets/img/2018-2-23-重启Ebaas服务器1.png' | prepend: site.baseurl }}" alt=""><br>

然后再重新启动Ebaas服务器，从“开始”- > Ebaas-> StartServer，见下图：<br>
<img src="{{'/assets/img/2018-2-23-重启Ebaas服务器3.png' | prepend: site.baseurl }}" alt=""><br>

以上操作完成了一个二维表格界面的配置，这个界面提供了对数据类的增删改查的各项操作。接下来的教程，我们介绍如何使用这个配置的界面对“事务”数据类进行增删改查的基本操作。

请点击左下方的链接回到上一个教程，点击右下方的链接进入下一个教程。
